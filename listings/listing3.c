#include <stdlib.h>
#include <string.h>

typedef struct Struct1{
  char field1[15];
  int field2;
}Struct1;

typedef struct Struct2{
  long item1;
  char item2;
}Struct2;

int main()
{
  /* Выделяем память под первую структуру */
  Struct1 *example1 = malloc(sizeof(struct Struct1));
  /* Копируем в первое поле строку Hello world! */
  strcpy(example1->field1, "Hello World!");
  example1->field2 = 9;

  /* Освобождаем память выделенную под первую структуру */
  free(example1);

  /* Выделяем память под вторую структуру и инициализируем данными */
  Struct2 *example2 = malloc(sizeof(struct Struct2));
  example2->item1 = 8;
  example2->item2 = 'a';

  /* Изменяем значение данных второй структуры используя уязвимость UAF */
  strcpy(example1->field1, "CORRUPTED!");

  return 0;
}
